<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[About System]]></title>
  <link href="http://io.kiyor.us/atom.xml" rel="self"/>
  <link href="http://io.kiyor.us/"/>
  <updated>2014-04-08T14:58:56-07:00</updated>
  <id>http://io.kiyor.us/</id>
  <author>
    <name><![CDATA[kiyor]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[how to make a simple audio/video streaming server]]></title>
    <link href="http://io.kiyor.us/blog/2014/03/17/how-to-make-a-simple-audio%2Cvideo-streaming-server/"/>
    <updated>2014-03-17T18:23:58-07:00</updated>
    <id>http://io.kiyor.us/blog/2014/03/17/how-to-make-a-simple-audio,video-streaming-server</id>
    <content type="html"><![CDATA[<ul>
  <li>
    <h2 id="why-need-it">Why need it</h2>

    <ul>
      <li>Music are pretty custom, hard to find a public streaming website that really fit for you.</li>
      <li>You have download music everyday. More and more storage you use, you might never out of space on you desktop, but how about your iphone, ipad, android device? or your working laptop?</li>
      <li>How to sync your music to different device? Each time download new music will need sync to different device.</li>
      <li>In 90%, you have wifi, not necessary have everything on your device.</li>
      <li>Download from torrent, then put to different device, after that you already not interested any more…</li>
      <li>I have Linux server skill!!!</li>
    </ul>
  </li>
  <li>
    <h2 id="if-you-have-problem-above-then-you-need-it">If you have problem above, then you need it.</h2>
  </li>
</ul>

<h2 id="basic-principle">Basic Principle</h2>

<ol>
  <li>Sync audio/video folder to your VPS or download by torrent.</li>
  <li>VPS auto detecting file type.</li>
  <li>VPS generate playlist for you.</li>
  <li>You able to access from all your device by access your VPS over html.</li>
</ol>

<h3 id="step-by-step-on-centos">Step by Step on CentOS</h3>

<ol>
  <li>Install <a href="http://www.transmissionbt.com">transmission</a> required lib on VPS</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
</pre></td><td class="code"><pre><code class=""><span class="line">cd /tmp
</span><span class="line">wget http://curl.haxx.se/download/curl-7.36.0.tar.gz
</span><span class="line">tar xvzf curl-7.36.0.tar.gz
</span><span class="line">cd curl-7.36.0
</span><span class="line">make &amp;&amp; make install
</span><span class="line">cd /tmp
</span><span class="line">wget https://github.com/downloads/libevent/libevent/libevent-2.0.21-stable.tar.gz
</span><span class="line">tar xvzf libevent-2.0.21-stable.tar.gz
</span><span class="line">cd libevent-2.0.21-stable
</span><span class="line">./configure
</span><span class="line">make &amp;&amp; make install</span></code></pre></td></tr></table></div></figure></notextile></div>
<ol>
  <li>Install <a href="http://www.transmissionbt.com">transmission</a></li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class=""><span class="line">cd /tmp
</span><span class="line">wget http://download.transmissionbt.com/files/transmission-2.82.tar.xz
</span><span class="line">tar xvfJ transmission-2.82.tar.xz
</span><span class="line">cd transmission-2.82
</span><span class="line">export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig
</span><span class="line">./configure
</span><span class="line">make &amp;&amp; make install</span></code></pre></td></tr></table></div></figure></notextile></div>
<ol>
  <li>Setup http mount point</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">useradd nginx</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>my example nginx vhost conf ( since I have lot of japanese content, I set html charset to shift_jis )</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
</pre></td><td class="code"><pre><code class=""><span class="line">server {
</span><span class="line">	listen		80;
</span><span class="line">	server_name	hostname;
</span><span class="line">	charset utf-8;
</span><span class="line">	root /home/nginx/html;
</span><span class="line">	location / {
</span><span class="line">		index index.html index.htm;
</span><span class="line">		autoindex on;
</span><span class="line">	}
</span><span class="line">	location /= {
</span><span class="line">		alias /home/nginx/html;
</span><span class="line">		index index.html index.htm;
</span><span class="line">		autoindex on;
</span><span class="line">	}
</span><span class="line">	location ~* \.(html|htm|txt)$ {
</span><span class="line">		index index.html index.htm;
</span><span class="line">		charset Shift_JIS;
</span><span class="line">	}
</span><span class="line">	location ~* player$ {
</span><span class="line">		index index.html index.htm;
</span><span class="line">		default_type 'text/html';
</span><span class="line">	}
</span><span class="line">}</span></code></pre></td></tr></table></div></figure></notextile></div>

<ol>
  <li>Init transmission config</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class=""><span class="line">su - nginx
</span><span class="line">transmission-daemon
</span><span class="line">killall transmission-daemon</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>suggestion config ( ~/.config/transmission-daemon/settings.json )</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class=""><span class="line">"rpc-enabled": true,
</span><span class="line">"rpc-username": "login username",
</span><span class="line">"rpc-password": "login password", 
</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>transmission smart enough if you using text password, it will convert to hash automatically</p>

<ol>
  <li>Install <a href="http://golang.org/doc/install">Golang</a> and my <a href="https://github.com/kiyor/playlist">Playlist Generator</a></li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class=""><span class="line">go get github.com/kiyor/playlist
</span><span class="line">go install github.com/kiyor/playlist
</span><span class="line">cp -r templates html/ #cp my repo's templates file to you html directory ( html/templates/*.tmpl )
</span><span class="line">cd html
</span><span class="line">git clone git@github.com:johndyer/mediaelement.git
</span><span class="line">git clone git@github.com:kiyor/mep-feature-playlist.git
</span></code></pre></td></tr></table></div></figure></notextile></div>
<ol>
  <li>Download or upload something to you html folder</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">su - nginx
</span><span class="line">transmission-daemon</span></code></pre></td></tr></table></div></figure></notextile></div>
<ul>
  <li>go to hostname:9091, upload torrent or magnet link and download to your html/bt</li>
  <li>after downloaded, try access your hostname/bt</li>
  <li>run playlist -dir ‘your html dir’, it would generate a file call player</li>
  <li>access your player in all your device</li>
</ul>

<h4 id="note">note</h4>

<ul>
  <li>current only support mp3/wav as audio mp4 as video</li>
</ul>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[puppet tips]]></title>
    <link href="http://io.kiyor.us/blog/2014/03/17/puppet-tips/"/>
    <updated>2014-03-17T12:39:18-07:00</updated>
    <id>http://io.kiyor.us/blog/2014/03/17/puppet-tips</id>
    <content type="html"><![CDATA[<ul>
  <li>puppet with nginx artical <a href="http://z0mbix.github.io">link</a></li>
  <li>important permission, <code>puppet:puppet puppet_config_dir/rack</code></li>
  <li>use templates is better for loadbalance, since you don’t need setup host in config, but speed is lower than files</li>
</ul>

<h6 id="example-nginx-conf">example nginx conf</h6>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
</pre></td><td class="code"><pre><code class=""><span class="line">
</span><span class="line">server {
</span><span class="line">    listen          8140 ssl;
</span><span class="line">    server_name     $hostname;
</span><span class="line">
</span><span class="line">    access_log      /usr/local/nginx/logs/puppet_access.log;
</span><span class="line">    error_log       /usr/local/nginx/logs/puppet_error.log;
</span><span class="line">
</span><span class="line">    ssl_certificate             /var/lib/puppet/ssl/certs/$hostname.pem;
</span><span class="line">    ssl_certificate_key         /var/lib/puppet/ssl/private_keys/$hostname.pem;
</span><span class="line">    ssl_crl                     /var/lib/puppet/ssl/ca/ca_crl.pem;
</span><span class="line">    ssl_client_certificate      /var/lib/puppet/ssl/certs/ca.pem;
</span><span class="line">    ssl_ciphers                 SSLv2:-LOW:-EXPORT:RC4+RSA;
</span><span class="line">    ssl_prefer_server_ciphers   on;
</span><span class="line">    ssl_verify_client           optional;
</span><span class="line">    ssl_verify_depth            1;
</span><span class="line">    ssl_session_cache           shared:SSL:128m;
</span><span class="line">    ssl_session_timeout         5m;
</span><span class="line">
</span><span class="line">    location / {
</span><span class="line">        root                      /etc/puppet/rack/public;
</span><span class="line">        passenger_base_uri        /;
</span><span class="line">        passenger_enabled         on;
</span><span class="line">        passenger_set_cgi_param   HTTP_X_CLIENT_DN $ssl_client_s_dn;
</span><span class="line">        passenger_set_cgi_param   HTTP_X_CLIENT_VERIFY $ssl_client_verify;
</span><span class="line">    }
</span><span class="line">}
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Force local user use proxy]]></title>
    <link href="http://io.kiyor.us/blog/2013/01/19/force-local-user-use-proxy/"/>
    <updated>2013-01-19T11:27:38-08:00</updated>
    <id>http://io.kiyor.us/blog/2013/01/19/force-local-user-use-proxy</id>
    <content type="html"><![CDATA[<p>Setup local squid.conf with <code>http_port 45678 transparent</code></p>

<p>ssh to your DD-WRT router and run</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">iptables -I FORWARD -p tcp -d 192.168.1.2 –dport 45678 -j ACCEPT
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>After accept local server forward make a script like ensquid.sh</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="c">#!/bin/sh</span>
</span><span class="line">iptables -t nat -I PREROUTING -p tcp -s <span class="nv">$1</span> –dport 80 -j DNAT –to 192.168.1.2:45678
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>add exec privilege and run</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">chmod u+x ensquid.sh
</span><span class="line">./ensquid.sh 192.168.1.x
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h3 id="why-i-do-that">Why I do that:</h3>
<ul>
  <li>Sucker game console not support use proxy everywhere, like WiiU cannot use proxy on Nico App</li>
  <li>I have two layer proxy setup for JP website. And ad deny feature on my proxy. Why not using it!</li>
</ul>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Cracked a Japanese iOS Online game...]]></title>
    <link href="http://io.kiyor.us/blog/2012/11/03/cracked-a-japanese-ios-online-game-dot-dot-dot/"/>
    <updated>2012-11-03T12:15:24-07:00</updated>
    <id>http://io.kiyor.us/blog/2012/11/03/cracked-a-japanese-ios-online-game-dot-dot-dot</id>
    <content type="html"><![CDATA[<p>These day I was playing a new iOS game named Road to Dragons, ロード・トゥ・ドラゴン.</p>

<p>Analysis the file system found all the cache data store form a plist file which is in <code>/Library/Preferences/jp.co.acquire.RTD.plist</code></p>

<p>In my experience this kind of game will connect to server when out of battle. It will use local calculator to calculate the battle result. So it could be cracked during the battle.</p>

<p>I found the plist file contain a line like <code>LOGINBONUS_PARAM</code></p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="json"><span class="line"><span class="p">{</span><span class="nt">&quot;m_BonusLife&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;m_BonusAttack&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;m_BonusRecovery&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;m_BonusEvoPoint&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;m_BonusSoulPoint&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;m_BonusCriticalRate&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;m_BonusDropRate&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;m_BonusQuestMoney&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;m_BonusQuestExp&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;m_BonusQuestFriendPoint&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>That’s a strange line in this mass file, so I change all 0 to 100000 and try to get all the bonus.</p>

<p>It worked…So this game company use client and clean text (Ok, only Xcode can open this plist file) to calculate the battle and even it is multiplication…</p>

<p>Ok…That’s my first time to crack a online game…Maybe I will try more later…</p>

<p><img src="http://kiyor.us/wp-content/uploads/2012/11/IMG_9087.png" alt="" /></p>

<h3 id="update">Update</h3>
<p>Pets soul could be changed too…</p>

<p>Edit MDBS30 and change quest’s reward_soul value…</p>

<p>What a suck game!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Control Different Region Player Connect Different Server]]></title>
    <link href="http://io.kiyor.us/blog/2012/08/19/control-different-region-player-connect-different-server/"/>
    <updated>2012-08-19T17:58:43-07:00</updated>
    <id>http://io.kiyor.us/blog/2012/08/19/control-different-region-player-connect-different-server</id>
    <content type="html"><![CDATA[<p>Recently I wanted to upgrade my Minecraft player. I plan to use different server for different player. I’ve tried to check how does my home’s DD-WRT works on port forwarding. And I got the result. I could use port forwarding in iptables control player source ip connect different server.</p>

<p>So this is my iptables rule</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
<span class="line-number">62</span>
<span class="line-number">63</span>
<span class="line-number">64</span>
<span class="line-number">65</span>
<span class="line-number">66</span>
<span class="line-number">67</span>
<span class="line-number">68</span>
<span class="line-number">69</span>
<span class="line-number">70</span>
<span class="line-number">71</span>
<span class="line-number">72</span>
<span class="line-number">73</span>
<span class="line-number">74</span>
<span class="line-number">75</span>
<span class="line-number">76</span>
<span class="line-number">77</span>
<span class="line-number">78</span>
<span class="line-number">79</span>
<span class="line-number">80</span>
<span class="line-number">81</span>
<span class="line-number">82</span>
<span class="line-number">83</span>
<span class="line-number">84</span>
<span class="line-number">85</span>
<span class="line-number">86</span>
<span class="line-number">87</span>
<span class="line-number">88</span>
<span class="line-number">89</span>
<span class="line-number">90</span>
<span class="line-number">91</span>
<span class="line-number">92</span>
<span class="line-number">93</span>
<span class="line-number">94</span>
<span class="line-number">95</span>
<span class="line-number">96</span>
<span class="line-number">97</span>
<span class="line-number">98</span>
<span class="line-number">99</span>
<span class="line-number">100</span>
<span class="line-number">101</span>
</pre></td><td class="code"><pre><code class=""><span class="line">Chain INPUT (policy ACCEPT)
</span><span class="line">target prot opt source destination
</span><span class="line">ACCEPT 0 -- 0.0.0.0/0 0.0.0.0/0 state RELATED,ESTABLISHED
</span><span class="line">DROP udp -- 0.0.0.0/0 0.0.0.0/0 udp dpt:520
</span><span class="line">DROP udp -- 0.0.0.0/0 0.0.0.0/0 udp dpt:520
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 0.0.0.0/0 udp dpt:520
</span><span class="line">logaccept tcp -- 0.0.0.0/0 192.168.1.1 tcp dpt:23
</span><span class="line">DROP icmp -- 0.0.0.0/0 0.0.0.0/0
</span><span class="line">DROP 2 -- 0.0.0.0/0 0.0.0.0/0
</span><span class="line">ACCEPT 0 -- 0.0.0.0/0 0.0.0.0/0 state NEW
</span><span class="line">logaccept 0 -- 0.0.0.0/0 0.0.0.0/0 state NEW
</span><span class="line">DROP 0 -- 0.0.0.0/0 0.0.0.0/0
</span><span class="line">Chain FORWARD (policy ACCEPT)
</span><span class="line">target prot opt source destination
</span><span class="line">ACCEPT 47 -- 192.168.1.0/24 0.0.0.0/0
</span><span class="line">ACCEPT tcp -- 192.168.1.0/24 0.0.0.0/0 tcp dpt:1723
</span><span class="line">ACCEPT 0 -- 0.0.0.0/0 0.0.0.0/0
</span><span class="line">TCPMSS tcp -- 0.0.0.0/0 0.0.0.0/0 tcp flags:0x06/0x02 TCPMSS clamp to PMTU
</span><span class="line">lan2wan 0 -- 0.0.0.0/0 0.0.0.0/0
</span><span class="line">ACCEPT 0 -- 0.0.0.0/0 0.0.0.0/0 state RELATED,ESTABLISHED
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.131 tcp dpt:25565
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.131 udp dpt:25565
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.131 tcp dpt:80
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.131 udp dpt:80
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.131 tcp dpt:443
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.131 udp dpt:443
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.131 tcp dpt:548
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.131 udp dpt:548
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.1 tcp dpt:80
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.1 udp dpt:80
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.1 tcp dpt:443
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.1 udp dpt:443
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.131 tcp dpt:22
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.131 udp dpt:22
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.133 tcp dpt:51413
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.133 udp dpt:51413
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.133 tcp dpt:9091
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.133 udp dpt:9091
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.131 tcp dpt:8123
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.131 udp dpt:8123
</span><span class="line">ACCEPT tcp -- 0.0.0.0/0 192.168.1.141 tcp dpt:6699
</span><span class="line">ACCEPT udp -- 0.0.0.0/0 192.168.1.141 udp dpt:6699
</span><span class="line">TRIGGER 0 -- 0.0.0.0/0 0.0.0.0/0 TRIGGER type:in match:0 relate:0
</span><span class="line">trigger_out 0 -- 0.0.0.0/0 0.0.0.0/0
</span><span class="line">ACCEPT 0 -- 0.0.0.0/0 0.0.0.0/0 state NEW
</span><span class="line">DROP 0 -- 0.0.0.0/0 0.0.0.0/0
</span><span class="line">Chain OUTPUT (policy ACCEPT)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_1 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_10 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_2 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_3 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_4 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_5 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_6 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_7 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_8 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain advgrp_9 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_1 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_10 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_2 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_3 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_4 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_5 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_6 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_7 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_8 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain grp_9 (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain lan2wan (1 references)
</span><span class="line">target prot opt source destination
</span><span class="line">Chain logaccept (2 references)
</span><span class="line">target prot opt source destination
</span><span class="line">ACCEPT 0 -- 0.0.0.0/0 0.0.0.0/0
</span><span class="line">Chain logdrop (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">DROP 0 -- 0.0.0.0/0 0.0.0.0/0
</span><span class="line">Chain logreject (0 references)
</span><span class="line">target prot opt source destination
</span><span class="line">REJECT tcp -- 0.0.0.0/0 0.0.0.0/0 tcp reject-with tcp-reset
</span><span class="line">Chain trigger_out (1 references)
</span><span class="line">target prot opt source destination
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The only useful in this table is FORWARD</p>

<p>The rule is looks like that</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">iptables -t nat -I PREROUTING -p tcp -d 192.168.1.1 --dport 10001 -j DNAT --to 192.168.1.131:10002
</span><span class="line">iptables -I FORWARD -p tcp -d 192.168.1.131 --dport 10002 -j ACCEPT
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Test Success.</p>

<p>The script</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="c">#!/bin/sh</span>
</span><span class="line">iptables -t nat -I PREROUTING -p tcp -s <span class="nv">$1</span> -d <span class="nv">$2</span> --dport <span class="nv">$3</span> -j DNAT --to <span class="nv">$2</span>:<span class="nv">$4</span>
</span><span class="line">iptables -I FORWARD -p tcp -s <span class="nv">$1</span> -d <span class="nv">$2</span> --dport <span class="nv">$3</span> -j ACCEPT
</span></code></pre></td></tr></table></div></figure></notextile></div>

<table>
  <thead>
    <tr>
      <th>$1:</th>
      <th>source ip</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>$2:</td>
      <td>server ip</td>
    </tr>
    <tr>
      <td>$3:</td>
      <td>service port</td>
    </tr>
    <tr>
      <td>$4:</td>
      <td>forward port</td>
    </tr>
  </tbody>
</table>

<p>So Now I can make my Chinese player play my Chinese server and US player play US server. The server could automatic choose server depends on region.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Use Ramdisk in Your Mac]]></title>
    <link href="http://io.kiyor.us/blog/2012/08/07/how-to-use-ramdisk-in-your-mac/"/>
    <updated>2012-08-07T17:01:15-07:00</updated>
    <id>http://io.kiyor.us/blog/2012/08/07/how-to-use-ramdisk-in-your-mac</id>
    <content type="html"><![CDATA[<p>You can simply use command to create a ramdisk.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">diskutil erasevolume HFS+ <span class="s2">&quot;ramdisk&quot;</span> <span class="sb">`</span>hdiutil attach -nomount ram://512000<span class="sb">`</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>This is 250 MB ramdisk, you can change 512000 to change the volume of the ramdisk.
If you want to use ramdisk for your safari cache
You can close the safari and run these</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">rm -rf ~/Library/Caches/com.apple.Safari
</span><span class="line">mkdir /Volumes/ramdisk/com.apple.Safari
</span><span class="line">ln -s /Volumes/ramdisk/com.apple.Safari/ ~/Library/Caches/com.apple.Safari
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Another app’s caches you can just modify path form the code above.</p>

<p>If you need it runs automatically when you reboot.
Create a script like ramedisk.sh and <code>chmod u+x ramdisk.sh</code></p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="c">#!/bin/sh</span>
</span><span class="line"><span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&quot;/Volumes/ramdisk&quot;</span> <span class="o">]</span>; <span class="k">then</span>
</span><span class="line"><span class="k">	</span>diskutil erasevolume HFS+ <span class="s2">&quot;ramdisk&quot;</span> <span class="sb">`</span>hdiutil attach -nomount ram://512000<span class="sb">`</span>
</span><span class="line"><span class="k">fi</span>
</span><span class="line"><span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&quot;/Volumes/ramdisk/com.apple.Safari&quot;</span> <span class="o">]</span>; <span class="k">then</span>
</span><span class="line"><span class="k">	</span>rm -rf ~/Library/Caches/com.apple.Safari
</span><span class="line">	mkdir /Volumes/ramdisk/com.apple.Safari
</span><span class="line">	ln -s /Volumes/ramdisk/com.apple.Safari/ ~/Library/Caches/com.apple.Safari
</span><span class="line"><span class="k">fi</span>
</span><span class="line"><span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&quot;/Volumes/ramdisk/Google&quot;</span> <span class="o">]</span>; <span class="k">then</span>
</span><span class="line"><span class="k">	</span>rm -rf ~/Library/Caches/Google
</span><span class="line">	mkdir /Volumes/ramdisk/Google
</span><span class="line">	ln -s /Volumes/ramdisk/Google/ ~/Library/Caches/Google
</span><span class="line"><span class="k">fi</span>
</span><span class="line"><span class="k"> </span>
</span><span class="line"><span class="k">if</span> <span class="o">[</span> -d <span class="s2">&quot;/Volumes/ramdisk/com.apple.Safari&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> -d <span class="s2">&quot;/Volumes/ramdisk/Google&quot;</span> <span class="o">]</span>; <span class="k">then</span>
</span><span class="line"><span class="k">	</span><span class="nb">echo</span> <span class="s2">&quot;Ramdisk is enabled!&quot;</span>
</span><span class="line"><span class="k">else</span>
</span><span class="line"><span class="k">	</span><span class="nb">echo</span> <span class="s2">&quot;Error&quot;</span>
</span><span class="line"><span class="k">fi</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>rc.local file might not work, Mac looks not load rc.local, what I do is append these to terminal login sheel and run terminal when Mac start. You need add a check like <code>if [[ $(tty) = /dev/ttys001 ]]; then ~/ramdisk.sh; fi;</code></p>

<p>You can also modify this if you need.
More information
Testing software: Blackmagic Disk Speed Test</p>

<table>
  <thead>
    <tr>
      <th>10 Bit YUV 4:2:2 PAL</th>
      <th>Default SSD</th>
      <th>Default Ramdisk</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Disk Write Speed MB/s</td>
      <td>180</td>
      <td>800</td>
    </tr>
    <tr>
      <td>Disk Read Speed MB/s</td>
      <td>210</td>
      <td>800</td>
    </tr>
  </tbody>
</table>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Share my Mac’s Apps List]]></title>
    <link href="http://io.kiyor.us/blog/2012/08/07/share-my-macs-apps-list/"/>
    <updated>2012-08-07T16:54:11-07:00</updated>
    <id>http://io.kiyor.us/blog/2012/08/07/share-my-macs-apps-list</id>
    <content type="html"><![CDATA[<p>Last year I bought 2011 Mac Air for learning Objective-C. Now I’m using OSX for my main environment.
Most of the people who never use OSX thought “Mac is over prices, only the hardware is good and not support a lot of apps”.
But most of Mac users love Mac is because the OS.
So apps I use to make me think Mac is awesome.</p>

<h3 id="st-xcode">1st: Xcode</h3>
<p>Without Xcode, your Mac is not completed. Not because you need programing something, just because you really need command line tools from Xcode. Regular command line is not enough to access some awesome command. After you install the Xcode and download the command line tools, your Mac is ready to go.</p>

<h3 id="nd-terminal">2nd: Terminal</h3>
<p>This topic will be very huge. Terminal could be use everywhere. The most important things on Terminal is because they can easily edit root file without any problem. Also you can ssh via terminal. Windows use putty, that’s not good. Terminal have great GUI, not only help you do your works but also make the works look amazing.</p>

<h3 id="rd-macports">3rd: MacPorts</h3>
<p>If you are familiar with Linux, you must know rpm and apt-get. port is similar like these, but port let you download the source and compile by yourself. The package might be install slowly and cpu will almost 100%. Whatever you could use a lot of Linux 3rd party package in your Mac like nmap, watch and so on.</p>

<h3 id="th-textmate">4th: TextMate</h3>
<p>TextMate is an awesome text editor in Mac. It could use a lot of plugin and even compile your code without other apps. What I have problem is I cannot change default table size as space, and also sometimes auto tab will annoying you.</p>

<h3 id="th-macvim">5th: MacVim</h3>
<p>Powerful, not not for newbie developer. I use MacVim for view the php or custom stuff. You could do whatever in Vim, same as MacVim. If you are developer, you should know how to use keyboard control the cursor at least.</p>

<h3 id="th-bbedit">6th: BBedit</h3>
<p>Good text editor for project diff and support real-time word suggestion. I purchase this app only for these two reason. OK, one more reason: it is available in App Store.</p>

<h3 id="th-coda--coda-2">7th: Coda / Coda 2</h3>
<p>If you are a web developer, You must have this app. This is the best php writer.</p>

<h3 id="th-sequel-pro">8th: Sequel Pro</h3>
<p>FREE MySql app. The GUI is sample, easy for use. If you should manage mysql database data, you must have it.</p>

<h3 id="th-navicat">9th: Navicat</h3>
<p>This app have a lot of version. You can try Navicat Premium first, and then try Navicat Premium Essentials. This app is best for SQL data structural; not very good for data editing.</p>

<h3 id="cyberduck">10: CyberDuck</h3>
<p>FREE / PAY ftp / sftp kind of app. This app is enough if you just use ftp for some time.</p>

<h3 id="transmit">11: Transmit</h3>
<p>Best ftp / sftp kind of app. The only thing is it could not zip the file by GUI. The GUI of the app is amazing.</p>

<h3 id="evernote">12: Evernote</h3>
<p>Good app for note, sync with all your device. Only poor is it is not stable when you offline.</p>

<h3 id="dropbox">13: Dropbox</h3>
<p>I don’t wanna say anything, if you don’t have account just click me.</p>

<h3 id="vmware">14: VMware</h3>
<p>If you will use Linux or Windows for some reason, you must have this one. It cost money but more like a product.</p>

<h3 id="virtualbox">15: VirtualBox</h3>
<p>FREE but not very good for GUI access. I think VirtualBox is best for virtual a server. You can modify more complex than VMware.</p>

<h3 id="github">16: GitHub</h3>
<p>If you have source code in your Mac, please use it to control it. It reduce your madness.</p>
]]></content>
  </entry>
  
</feed>
